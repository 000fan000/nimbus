<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Nimbus: Nimbus Models</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24278774-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body>
<div id="page">
<div style="position:relative">
<div id="top"><!-- do not remove this div! -->

<div id="titlearea">
<a style="float: right;margin-right:20px;margin-top:20px" href='http://www.pledgie.com/campaigns/15519'><img alt='Click here to support Nimbus development and make a donation at www.pledgie.com !' src='http://www.pledgie.com/campaigns/15519.png?skin_name=chrome' border='0' /></a>
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Nimbus
   &#160;<span id="projectnumber">0.7.0 - <a href="http://github.com/jverkoey/nimbus">Nimbus is proudly hosted on Github</a></span>
   </div>
   <div id="projectbrief">An iOS framework whose growth is bounded by O(documentation).</div>
  </td>
  
  
  
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.4-20110629 -->
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('group___nimbus_models.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">Nimbus Models</div>  </div>
</div>
<div class="contents">
<hr/><a name="details" id="details"></a><h2>Overview</h2>
<p>A model is an implementation of a data source protocol. </p>
<p>Data sources are required by various UI components throughout UIKit and <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a>. It can be painful to have to rewrite the same data source logic over and over again. <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> models allow you to separate the data source logic from your view controller and recycle common functionality throughout your application. You'll find that your view controller can then focus on the broader implementation details rather than implementing dozens of data source methods.</p>
<h2>Vanilla UIKit vs <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> Models</h2>
<p>Presented below is a side-by-side comparison of implementing a table view controller with pure UIKit (on the left) and implementing the same controller with <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> (on the right). This comparison's purpose is to show the reduction in amount of code to be written. The code that has been completely removed is grayed out on the left.</p>
<p>If you would like to see an example of <a class="el" href="interface_nimbus.html" title="The Nimbus state interface.">Nimbus</a> models being used, check out the ModelCatalog example application.</p>
 
 <div class="side-by-side-compare">
 <pre>
 @implementation CatalogTableViewController
 
 #pragma mark -
 #pragma mark UITableViewDataSource
 
 - (NSArray *)rows {
   static NSArray* rows = nil;
   if (nil == rows) {
     rows = [NSArray arrayWithObjects:
             @"Dribbble",
             [NSDictionary dictionaryWithObjectsAndKeys:
              [DribbblePhotoAlbumViewController class], @"class",
              @"Popular Shots", @"title",
              @"/shots", @"initWith",
              nil],
             [NSDictionary dictionaryWithObjectsAndKeys:
              [DribbblePhotoAlbumViewController class], @"class",
              @"Everyone's Shots", @"title",
              @"/shots/everyone", @"initWith",
              nil],
             [NSDictionary dictionaryWithObjectsAndKeys:
              [DribbblePhotoAlbumViewController class], @"class",
              @"Debuts", @"title",
              @"/shots/debuts", @"initWith",
              nil],
 
             @"Facebook Albums",
             [NSDictionary dictionaryWithObjectsAndKeys:
              [FacebookPhotoAlbumViewController class], @"class",
              @"120th Commencement in Pictures", @"title",
              @"10150219083838418", @"initWith",
              nil],
             [NSDictionary dictionaryWithObjectsAndKeys:
              [FacebookPhotoAlbumViewController class], @"class",
              @"Stanford 40th Annual Powwow", @"title",
              @"10150185938728418", @"initWith",
              nil],
             [NSDictionary dictionaryWithObjectsAndKeys:
              [FacebookPhotoAlbumViewController class], @"class",
              @"Spring blossoms at Stanford", @"title",
              @"10150160584103418", @"initWith",
              nil],
             [NSDictionary dictionaryWithObjectsAndKeys:
              [FacebookPhotoAlbumViewController class], @"class",
              @"Shark Week", @"title",
              @"208546235826221", @"initWith",
              nil],
             [NSDictionary dictionaryWithObjectsAndKeys:
              [FacebookPhotoAlbumViewController class], @"class",
              @"Game of Thrones", @"title",
              @"489714642733", @"initWith",
              nil],
 
             nil];
     [rows retain];
   }
   return rows;
 }
 <span style="color:gray">
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
   NSArray* rows = [self rows];
 
   NSInteger numberOfSections = 0;
   for (id object in rows) {
     numberOfSections += [object isKindOfClass:[NSString class]];
   }
 
   return MAX(1, numberOfSections);
 }
 
 - (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
   NSArray* rows = [self rows];
 
   NSInteger sectionIndex = -1;
   for (id object in rows) {
     sectionIndex += [object isKindOfClass:[NSString class]];
 
     if (sectionIndex == section) {
       return object;
     }
   }
 
   return nil;
 }
 
 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
   NSArray* rows = [self rows];
 
   NSInteger sectionIndex = -1;
   NSInteger numberOfRows = 0;
   for (id object in rows) {
     sectionIndex += [object isKindOfClass:[NSString class]];
 
     if (sectionIndex == section && [object isKindOfClass:[NSDictionary class]]) {
       numberOfRows++;
     } else if (numberOfRows > 0) {
       break;
     }
   }
 
   return numberOfRows;
 }
 
 - (id)objectForIndexPath:(NSIndexPath *)indexPath {
   // UGH: This is slow. Thankfully it doesn't matter because we know that we're only ever going to
   // have < 100 items or so.
 
   NSArray* rows = [self rows];
 
   NSInteger sectionIndex = -1;
   NSInteger rowIndex = -1;
   for (id object in rows) {
     sectionIndex += [object isKindOfClass:[NSString class]];
 
     if (sectionIndex == [indexPath section] && [object isKindOfClass:[NSDictionary class]]) {
       rowIndex++;
     } else if (rowIndex >= 0) {
       break;
     }
 
     if (rowIndex == [indexPath row] && sectionIndex == [indexPath section]) {
       return object;
     }
   }
 
   return nil;
 }</span>
 
 - (UITableViewCell *)tableView: (UITableView *)tableView
          cellForRowAtIndexPath: (NSIndexPath *)indexPath {
   UITableViewCell* cell = [tableView dequeueReusableCellWithIdentifier:@"row"];
 
   if (nil == cell) {
     cell = [[[UITableViewCell alloc] initWithStyle: UITableViewCellStyleDefault
                                    reuseIdentifier: @"row"]
             autorelease];
     cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
   }
 
   id object = [self objectForIndexPath:indexPath];
 
   cell.textLabel.text = [object objectForKey:@"title"];
 
   return cell;
 }
 
 
 #pragma mark -
 #pragma mark UITableViewDelegate
 
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
   id object = [self objectForIndexPath:indexPath];
 
   Class vcClass = [object objectForKey:@"class"];
   id initWith = [object objectForKey:@"initWith"];
   NSString* title = [object objectForKey:@"title"];
   UIViewController* vc = [[[vcClass alloc] initWith:initWith] autorelease];
   vc.title = title;
 
   [self.navigationController pushViewController:vc animated:YES];
 }
 
 @end</pre>
 </div>

 <div class="side-by-side-compare">
 <pre>
 @implementation CatalogTableViewController
 
 - (void)dealloc {
   NI_RELEASE_SAFELY(_model);
   [super dealloc];
 }
 
 - (id)initWithStyle:(UITableViewStyle)style {
   if ((self = [super initWithStyle:style])) {
     NSArray* tableContents =
     [NSArray arrayWithObjects:
      @"Dribbble",
      [NSDictionary dictionaryWithObjectsAndKeys:
       [DribbblePhotoAlbumViewController class], @"class",
       @"Popular Shots", @"title",
       @"/shots", @"initWith",
       nil],
      [NSDictionary dictionaryWithObjectsAndKeys:
       [DribbblePhotoAlbumViewController class], @"class",
       @"Everyone's Shots", @"title",
       @"/shots/everyone", @"initWith",
       nil],
      [NSDictionary dictionaryWithObjectsAndKeys:
       [DribbblePhotoAlbumViewController class], @"class",
       @"Debuts", @"title",
       @"/shots/debuts", @"initWith",
       nil],
      
      @"Facebook Albums",
      [NSDictionary dictionaryWithObjectsAndKeys:
       [FacebookPhotoAlbumViewController class], @"class",
       @"120th Commencement in Pictures", @"title",
       @"10150219083838418", @"initWith",
       nil],
      [NSDictionary dictionaryWithObjectsAndKeys:
       [FacebookPhotoAlbumViewController class], @"class",
       @"Stanford 40th Annual Powwow", @"title",
       @"10150185938728418", @"initWith",
       nil],
      [NSDictionary dictionaryWithObjectsAndKeys:
       [FacebookPhotoAlbumViewController class], @"class",
       @"Spring blossoms at Stanford", @"title",
       @"10150160584103418", @"initWith",
       nil],
      [NSDictionary dictionaryWithObjectsAndKeys:
       [FacebookPhotoAlbumViewController class], @"class",
       @"Shark Week", @"title",
       @"208546235826221", @"initWith",
       nil],
      [NSDictionary dictionaryWithObjectsAndKeys:
       [FacebookPhotoAlbumViewController class], @"class",
       @"Game of Thrones", @"title",
       @"489714642733", @"initWith",
       nil],
      nil];
     _model = [[NITableViewModel alloc] initWithSectionedArray:tableContents
                                                      delegate:self];
   }
   return self;
 }
 
 - (void)viewDidLoad {
   [super viewDidLoad];
 
   self.tableView.dataSource = _model;
 }
 
 #pragma mark -
 #pragma mark NITableViewModelDelegate
 
 - (UITableViewCell *)tableViewModel: (NITableViewModel *)tableViewModel
                    cellForTableView: (UITableView *)tableView
                         atIndexPath: (NSIndexPath *)indexPath
                          withObject: (id)object {
   UITableViewCell* cell = [tableView dequeueReusableCellWithIdentifier:@"row"];
 
   if (nil == cell) {
     cell = [[[UITableViewCell alloc] initWithStyle: UITableViewCellStyleDefault
                                    reuseIdentifier: @"row"]
             autorelease];
     cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
   }
 
   cell.textLabel.text = [object objectForKey:@"title"];
 
   return cell;
 }
 
 #pragma mark -
 #pragma mark UITableViewDelegate
 
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
   id object = [_model objectAtIndexPath:indexPath];
 
   Class vcClass = [object objectForKey:@"class"];
   id initWith = [object objectForKey:@"initWith"];
   NSString* title = [object objectForKey:@"title"];
   UIViewController* vc = [[[vcClass alloc] initWith:initWith] autorelease];
   vc.title = title;
 
   [self.navigationController pushViewController:vc animated:YES];
 }
 
 @end</pre>
 </div>
 <div class="clearfix"></div>
  <table class="memberdecls">
<tr><td colspan="2"><h2><a name="groups"></a>
Modules</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___table_view_models.html">Table View Models</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___table_cell_factory.html">Table Cell Factory</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___table_cell_catalog.html">Table Cell Catalog</a></td></tr>
</table>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
</div><!-- .fixedwidth -->


    <span class="footer">Generated for Nimbus by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4-20110629 </span>
   </ul>
 </div>


</div> <!-- page -->
</body>
</html>
